1. SELECT branch_name FROM branch WHERE assets < ALL(SELECT assets FROM branch WHERE branch_city = "Brooklyn");
2. SELECT customer_name FROM customer C, depositor D, account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number AND customer_name! = "Johnson" AND A.branch_name IN (SELECT branch_name FROM customer C, depositor D, account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number AND C.customer_name = "Johnson");
3. SELECT AVG(balance) FROM ((customer C INNER JOIN depositor D ON C.customer_id = D.customer_id) INNER JOIN account A ON D.account_number = A.account_number) GROUP BY C.customer_city HAVING C.customer_city = "Palo Alto" AND COUNT(C.customer_id) > 1;
4. SELECT A.branch_name, COUNT(DISTINCT customer_id) FROM account A, depositor D WHERE (customer_id,branch_name) IN (SELECT customer_id, branch_name FROM account A, depositor D WHERE D.account_number = A.account_number GROUP BY A.branch_name) GROUP BY A.branch_name;
5. SELECT C.customer_name, A.account_number FROM customer C, depositor D, account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number ORDER BY A.balance DESC LIMIT 2 OFFSET 0;
6. SELECT branch_name, balance*0.04 AS total_interest FROM account GROUP BY branch_name;
7. SELECT customer_name FROM customer C, depositor D, Account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number AND A.branch_name = "Perryridge" AND customer_name IN (SELECT customer_name FROM customer C, borrower B, loan L WHERE C.customer_id = B.customer_id AND B.loan_number = L.loan_number AND L.branch_name = "Perryridge");
8. SELECT A.account_number, MAX(balance) FROM customer C, depositor D, account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number GROUP BY C.customer_city;
9. SELECT customer_name FROM customer C, depositor D, account A WHERE C.customer_id = D.customer_id AND D.account_number = A.account_number AND A.branch_name = "Perryridge" AND customer_name NOT IN (SELECT customer_name FROM customer C, borrower B, loan L WHERE C.customer_id = B.customer_id AND B.loan_number = L.loan_number AND L.branch_name = "Perryridge");
10. SELECT branch_name FROM branch WHERE assets < ALL(SELECT assets FROM branch WHERR branch_city = "Brooklyn");